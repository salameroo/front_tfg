"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9398],{9398:function(e,a,r){r.r(a),r.d(a,{default:function(){return z}});var s=r(7437),t=r(2265),n=r(3980),l=r(7440);let o=t.forwardRef((e,a)=>{let{className:r,type:t,...n}=e;return(0,s.jsx)("input",{type:t,className:(0,l.cn)("flex h-10 w-full rounded-md border border-gray-200 bg-white px-3 py-2 text-sm ring-offset-white file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-gray-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-950 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 dark:border-gray-800 dark:bg-gray-950 dark:ring-offset-gray-950 dark:placeholder:text-gray-400 dark:focus-visible:ring-gray-300",r),ref:a,...n})});o.displayName="Input";var d=r(9412),i=r(9789),c=r(7592),g=r(2468),u=r(8165);let h=i.fC,f=i.xz;i.ZA,i.Uv,i.Tr;let m=i.Ee;t.forwardRef((e,a)=>{let{className:r,inset:t,children:n,...o}=e;return(0,s.jsxs)(i.fF,{ref:a,className:(0,l.cn)("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-gray-100 data-[state=open]:bg-gray-100 dark:focus:bg-gray-800 dark:data-[state=open]:bg-gray-800",t&&"pl-8",r),...o,children:[n,(0,s.jsx)(c.Z,{className:"ml-auto h-4 w-4"})]})}).displayName=i.fF.displayName,t.forwardRef((e,a)=>{let{className:r,...t}=e;return(0,s.jsx)(i.tu,{ref:a,className:(0,l.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border border-gray-200 bg-white p-1 text-gray-950 shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 dark:border-gray-800 dark:bg-gray-950 dark:text-gray-50",r),...t})}).displayName=i.tu.displayName;let x=t.forwardRef((e,a)=>{let{className:r,sideOffset:t=4,...n}=e;return(0,s.jsx)(i.Uv,{children:(0,s.jsx)(i.VY,{ref:a,sideOffset:t,className:(0,l.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border border-gray-200 bg-white p-1 text-gray-950 shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 dark:border-gray-800 dark:bg-gray-950 dark:text-gray-50",r),...n})})});x.displayName=i.VY.displayName,t.forwardRef((e,a)=>{let{className:r,inset:t,...n}=e;return(0,s.jsx)(i.ck,{ref:a,className:(0,l.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-gray-100 focus:text-gray-900 data-[disabled]:pointer-events-none data-[disabled]:opacity-50 dark:focus:bg-gray-800 dark:focus:text-gray-50",t&&"pl-8",r),...n})}).displayName=i.ck.displayName,t.forwardRef((e,a)=>{let{className:r,children:t,checked:n,...o}=e;return(0,s.jsxs)(i.oC,{ref:a,className:(0,l.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-gray-100 focus:text-gray-900 data-[disabled]:pointer-events-none data-[disabled]:opacity-50 dark:focus:bg-gray-800 dark:focus:text-gray-50",r),checked:n,...o,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(i.wU,{children:(0,s.jsx)(g.Z,{className:"h-4 w-4"})})}),t]})}).displayName=i.oC.displayName;let y=t.forwardRef((e,a)=>{let{className:r,children:t,...n}=e;return(0,s.jsxs)(i.Rk,{ref:a,className:(0,l.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-gray-100 focus:text-gray-900 data-[disabled]:pointer-events-none data-[disabled]:opacity-50 dark:focus:bg-gray-800 dark:focus:text-gray-50",r),...n,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(i.wU,{children:(0,s.jsx)(u.Z,{className:"h-2 w-2 fill-current"})})}),t]})});y.displayName=i.Rk.displayName;let p=t.forwardRef((e,a)=>{let{className:r,inset:t,...n}=e;return(0,s.jsx)(i.__,{ref:a,className:(0,l.cn)("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",r),...n})});p.displayName=i.__.displayName;let j=t.forwardRef((e,a)=>{let{className:r,...t}=e;return(0,s.jsx)(i.Z0,{ref:a,className:(0,l.cn)("-mx-1 my-1 h-px bg-gray-100 dark:bg-gray-800",r),...t})});j.displayName=i.Z0.displayName;var v=r(2649),b=e=>{let{selectedUser:a,onClose:r}=e,[l,i]=(0,t.useState)([]),[c,g]=(0,t.useState)(""),[u,h]=(0,t.useState)(!0),[f,m]=(0,t.useState)(null);(0,t.useEffect)(()=>{a&&(async()=>{try{let e=await fetch("".concat("http://localhost:8000","/api/messages/").concat(a.id),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(v.Z.get("auth_token"))},credentials:"include"});if(!e.ok)throw Error("Failed to fetch messages");let r=await e.json();console.log("Fetched messages:",r),i(r),h(!1)}catch(e){e instanceof Error?m(e.message):m("An unknown error occurred"),h(!1)}})()},[a]);let x=async e=>{if(e.preventDefault(),c.trim()&&a)try{console.log("Sending message:",{receiver_id:a.id,message:c});let e=await fetch("".concat("http://localhost:8000","/api/messages"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(v.Z.get("auth_token"))},credentials:"include",body:JSON.stringify({receiver_id:a.id,message:c})});if(!e.ok){let a=await e.json();throw Error(a.message||"Failed to send message")}let r=await e.json();i([...l,r]),g("")}catch(e){e instanceof Error?m(e.message):m("An unknown error occurred")}};return u?(0,s.jsx)("div",{children:"Loading..."}):f?(0,s.jsxs)("div",{children:["Error: ",f]}):a?(0,s.jsxs)("div",{className:"flex flex-col h-[80vh] max-w-full mx-auto border border-gray-200 rounded-lg overflow-hidden dark:border-gray-800",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between bg-gray-100 dark:bg-gray-800 px-4 py-3 border-b",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)(n.qE,{className:"w-8 h-8",children:[(0,s.jsx)(n.F$,{alt:"@".concat(a.name),src:a.avatar||"/placeholder-user.jpg"}),(0,s.jsx)(n.Q5,{children:a.name[0]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:a.name}),(0,s.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Online"})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)(d.z,{size:"icon",variant:"ghost",children:[(0,s.jsx)(w,{className:"w-5 h-5"}),(0,s.jsx)("span",{className:"sr-only",children:"Attach file"})]}),(0,s.jsxs)(d.z,{size:"icon",variant:"ghost",children:[(0,s.jsx)(k,{className:"w-5 h-5"}),(0,s.jsx)("span",{className:"sr-only",children:"Send emoji"})]})]})]}),(0,s.jsx)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:l.map(e=>(0,s.jsxs)("div",{className:"flex items-end gap-3 ".concat(e.sender_id===a.id?"justify-start":"justify-end"),children:[e.sender_id!==a.id&&(0,s.jsxs)(n.qE,{className:"w-8 h-8",children:[(0,s.jsx)(n.F$,{alt:"@".concat(a.name),src:a.avatar||"/placeholder-user.jpg"}),(0,s.jsx)(n.Q5,{children:a.name[0]})]}),(0,s.jsxs)("div",{className:"px-4 py-2 rounded-lg max-w-[70%] ".concat(e.sender_id===a.id?"bg-gray-100 dark:bg-gray-800 rounded-bl-none":"bg-blue-500 text-white rounded-br-none"),children:[e.message," "]}),e.sender_id===a.id&&(0,s.jsxs)(n.qE,{className:"w-8 h-8",children:[(0,s.jsx)(n.F$,{alt:"@".concat(a.name),src:a.avatar||"/placeholder-user.jpg"}),(0,s.jsx)(n.Q5,{children:a.name[0]})]})]},e.id))}),(0,s.jsx)("div",{className:"bg-gray-100 dark:bg-gray-800 px-4 py-3 border-t",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(o,{autoComplete:"off",className:"flex-1",placeholder:"Type your message...",value:c,onChange:e=>g(e.target.value)}),(0,s.jsxs)(d.z,{size:"icon",variant:"ghost",onClick:x,children:[(0,s.jsx)(N,{className:"w-5 h-5"}),(0,s.jsx)("span",{className:"sr-only",children:"Send message"})]})]})})]}):(0,s.jsx)("div",{children:"No user selected"})};function w(e){return(0,s.jsx)("svg",{...e,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,s.jsx)("path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48"})})}function N(e){return(0,s.jsxs)("svg",{...e,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("path",{d:"m22 2-7 20-4-9-9-4Z"}),(0,s.jsx)("path",{d:"M22 2 11 13"})]})}function k(e){return(0,s.jsxs)("svg",{...e,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,s.jsx)("path",{d:"M8 14s1.5 2 4 2 4-2 4-2"}),(0,s.jsx)("line",{x1:"9",x2:"9.01",y1:"9",y2:"9"}),(0,s.jsx)("line",{x1:"15",x2:"15.01",y1:"9",y2:"9"})]})}var E=r(7699),_=r(3761);function z(){let[e,a]=(0,t.useState)([]),[r,l]=(0,t.useState)(!0),[i,c]=(0,t.useState)(null),[g,u]=(0,t.useState)(null),[w,N]=(0,t.useState)(!1),[k,z]=(0,t.useState)([]);(0,t.useEffect)(()=>{(async()=>{try{let e=await fetch("".concat("http://localhost:8000","/api/conversations"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(v.Z.get("auth_token"))},credentials:"include"});if(!e.ok)throw Error("Failed to fetch conversations: ".concat(e.statusText));let r=await e.json();console.log("Fetched conversations:",r),a(r),l(!1)}catch(e){console.error("Error fetching conversations:",e),e instanceof Error?c(e.message):c("An unknown error occurred"),l(!1)}})()},[]);let C=e=>{u(e)},F=async()=>{try{let e=await fetch("".concat("http://localhost:8000","/api/users"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(v.Z.get("auth_token"))},credentials:"include"});if(!e.ok)throw Error("Failed to fetch users: ".concat(e.statusText));let a=await e.json();console.log("Fetched users:",a.users),z(a.users),N(!0)}catch(e){console.error("Error fetching users:",e),e instanceof Error?c(e.message):c("An unknown error occurred")}},S=e=>{N(!1),u(e)};return r?(0,s.jsx)("div",{children:"Loading..."}):i?(0,s.jsxs)("div",{children:["Error: ",i]}):(0,s.jsx)("div",{className:"w-full mx-auto py-6 px-4 md:px-6",children:g?(0,s.jsx)(b,{selectedUser:g,onClose:()=>{u(null)}}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"w-full bg-gray-100 dark:bg-gray-800 rounded-lg overflow-hidden",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4 px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:[(0,s.jsxs)("div",{className:"relative flex-1",children:[(0,s.jsx)(E.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-500 dark:text-gray-400"}),(0,s.jsx)(o,{className:"pl-10 pr-4 py-2 rounded-md w-full bg-white dark:bg-gray-950 focus:outline-none focus:ring-1 focus:ring-gray-950 dark:focus:ring-gray-300",placeholder:"Search messages...",type:"search"})]}),(0,s.jsx)(d.z,{className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",onClick:F,children:"Nuevo chat"}),(0,s.jsxs)(h,{children:[(0,s.jsx)(f,{asChild:!0,children:(0,s.jsxs)(d.z,{className:"rounded-full",size:"icon",variant:"ghost",children:[(0,s.jsx)(_.Z,{className:"w-5 h-5"}),(0,s.jsx)("span",{className:"sr-only",children:"Filtrar mensajes"})]})}),(0,s.jsxs)(x,{align:"end",className:"w-48",children:[(0,s.jsx)(p,{children:"Ordenar por"}),(0,s.jsx)(j,{}),(0,s.jsxs)(m,{value:"recent",children:[(0,s.jsx)(y,{value:"recent",children:"Recientes"}),(0,s.jsx)(y,{value:"unread",children:"No leidos"}),(0,s.jsx)(y,{value:"oldest",children:"Antiguedad"})]})]})]})]}),(0,s.jsx)("div",{className:"h-[calc(100vh_-_theme(spacing.24)_-_theme(spacing.6))] overflow-y-auto",children:(0,s.jsx)("div",{className:"grid gap-4 p-4",children:e.map(e=>(0,s.jsxs)("div",{className:"flex items-start gap-4 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors cursor-pointer",onClick:()=>C({id:e.id,name:e.name,avatar:e.avatar}),children:[(0,s.jsxs)(n.qE,{className:"w-12 h-12",children:[(0,s.jsx)(n.F$,{alt:"@".concat(e.name),src:e.avatar||"/placeholder-user.jpg"}),(0,s.jsx)(n.Q5,{children:e.name[0]})]}),(0,s.jsxs)("div",{className:"flex-1 grid gap-1",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("div",{className:"font-medium",children:e.name}),e.last_message&&(0,s.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:new Date(e.last_message.created_at).toLocaleTimeString()})]}),(0,s.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400 line-clamp-1",children:e.last_message?e.last_message.content:"No messages yet"})]})]},e.id))})})]}),w&&(0,s.jsx)("div",{className:"fixed inset-0 bg-gray-800 bg-opacity-75 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-900 p-6 rounded-lg",children:[(0,s.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Empieza una nueva Conversaci\xf3n"}),(0,s.jsx)("ul",{children:Array.isArray(k)&&k.length>0?k.map(e=>(0,s.jsxs)("li",{className:"flex items-center gap-4 p-2 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800 rounded",onClick:()=>S(e),children:[(0,s.jsxs)(n.qE,{className:"w-8 h-8",children:[(0,s.jsx)(n.F$,{alt:"@".concat(e.name),src:e.profile_image||"/placeholder-user.jpg"}),(0,s.jsx)(n.Q5,{children:e.name[0]})]}),(0,s.jsx)("span",{children:e.name})]},e.id)):(0,s.jsx)("li",{children:"No se han encontrado usuarios."})}),(0,s.jsx)(d.z,{className:"mt-4 bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded",onClick:()=>N(!1),children:"Cancelar"})]})})]})})}},3980:function(e,a,r){r.d(a,{F$:function(){return d},Q5:function(){return i},qE:function(){return o}});var s=r(7437),t=r(2265),n=r(4458),l=r(7440);let o=t.forwardRef((e,a)=>{let{className:r,...t}=e;return(0,s.jsx)(n.fC,{ref:a,className:(0,l.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",r),...t})});o.displayName=n.fC.displayName;let d=t.forwardRef((e,a)=>{let{className:r,...t}=e;return(0,s.jsx)(n.Ee,{ref:a,className:(0,l.cn)("aspect-square h-full w-full",r),...t})});d.displayName=n.Ee.displayName;let i=t.forwardRef((e,a)=>{let{className:r,...t}=e;return(0,s.jsx)(n.NY,{ref:a,className:(0,l.cn)("flex h-full w-full items-center justify-center rounded-full bg-gray-100 dark:bg-gray-800",r),...t})});i.displayName=n.NY.displayName},9412:function(e,a,r){r.d(a,{z:function(){return i}});var s=r(7437),t=r(2265),n=r(1538),l=r(2218),o=r(7440);let d=(0,l.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-white transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-950 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 dark:ring-offset-gray-950 dark:focus-visible:ring-gray-300",{variants:{variant:{default:"bg-gray-900 text-gray-50 hover:bg-gray-900/90 dark:bg-gray-50 dark:text-gray-900 dark:hover:bg-gray-50/90",destructive:"bg-red-500 text-gray-50 hover:bg-red-500/90 dark:bg-red-900 dark:text-gray-50 dark:hover:bg-red-900/90",outline:"border border-gray-200 bg-white hover:bg-gray-100 hover:text-gray-900 dark:border-gray-800 dark:bg-gray-950 dark:hover:bg-gray-800 dark:hover:text-gray-50",secondary:"bg-gray-100 text-gray-900 hover:bg-gray-100/80 dark:bg-gray-800 dark:text-gray-50 dark:hover:bg-gray-800/80",ghost:"hover:bg-gray-100 hover:text-gray-900 dark:hover:bg-gray-800 dark:hover:text-gray-50",link:"text-gray-900 underline-offset-4 hover:underline dark:text-gray-50"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),i=t.forwardRef((e,a)=>{let{className:r,variant:t,size:l,asChild:i=!1,...c}=e,g=i?n.g7:"button";return(0,s.jsx)(g,{className:(0,o.cn)(d({variant:t,size:l,className:r})),ref:a,...c})});i.displayName="Button"},7440:function(e,a,r){r.d(a,{cn:function(){return n}});var s=r(4839),t=r(6164);function n(){for(var e=arguments.length,a=Array(e),r=0;r<e;r++)a[r]=arguments[r];return(0,t.m6)((0,s.W)(a))}}}]);