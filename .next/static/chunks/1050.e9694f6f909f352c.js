"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1050],{61050:function(e,t,s){s.r(t),s.d(t,{default:function(){return y}});var a=s(57437),r=s(2265),o=s(38472),l=s(44785),n=s(66648),i=s(87138),d=s(43153),c=s(91326),m=s(40468),h=s(80511),x=s(97594),u=s(60335),p=s(6438),g=s(58754),f=s(56604);s(9051),s(55291);var j=e=>{var t;let{postId:s,isOpen:o,onClose:n}=e,[i,j]=(0,r.useState)(null),[y,b]=(0,r.useState)(!0),[w,v]=(0,r.useState)(null),[N,k]=(0,r.useState)(null);(0,r.useEffect)(()=>{(async()=>{try{let e=await fetch("".concat("http://localhost:8000","/api/user"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(l.Z.get("auth_token"))},credentials:"include"});if(!e.ok)throw Error("Failed to fetch user");let t=await e.json();k(t.id)}catch(e){e instanceof Error?v(e.message):v("An unknown error occurred"),b(!1)}})()},[]),(0,r.useEffect)(()=>{let e=async()=>{try{let e=await fetch("".concat("http://localhost:8000","/api/posts/").concat(s),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(l.Z.get("auth_token"))},credentials:"include"});if(!e.ok)throw Error("Failed to fetch post");let t=await e.json();j(t),b(!1)}catch(e){e instanceof Error?v(e.message):v("An unknown error occurred"),b(!1)}};null!==N&&e()},[N,s]);let S=async()=>{if(i)try{let e=await fetch("".concat("http://localhost:8000","/api/posts/").concat(s,"/like"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(l.Z.get("auth_token"))},credentials:"include"});if(!e.ok)throw Error("Failed to like/unlike the post");let t=(await e.json()).liked?[...i.likes,{id:Date.now(),user_id:N,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}]:i.likes.filter(e=>e.user_id!==N);j({...i,likes:t})}catch(e){console.error("Error liking/unliking the post:",e)}},C=async e=>{if(i)try{let t=await fetch("".concat("http://localhost:8000","/api/posts/").concat(s,"/comment"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(l.Z.get("auth_token"))},credentials:"include",body:JSON.stringify({text:e})});if(!t.ok)throw Error("Failed to comment on the post");let a=await t.json();j({...i,comments:[...i.comments,a]})}catch(e){console.error("Error commenting on the post:",e)}};return y?(0,a.jsxs)(c.Z,{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",height:"100vh",children:[(0,a.jsx)(m.Z,{}),(0,a.jsx)(h.Z,{variant:"body1",className:"ml-2",children:"Cargando..."})]}):w?(0,a.jsxs)("div",{children:["Error: ",w]}):i?(0,a.jsx)(x.Z,{open:o,onClose:n,"aria-labelledby":"post-modal-title","aria-describedby":"post-modal-description",children:(0,a.jsxs)(c.Z,{className:"post-details",sx:{p:4,maxWidth:800,margin:"auto",bgcolor:"background.paper",boxShadow:24,borderRadius:2},children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-2",children:i.title}),(0,a.jsx)("p",{className:"mb-2",children:i.content}),i.images.length>0&&(0,a.jsx)(d.Z,{dots:!0,infinite:!0,speed:500,slidesToShow:1,slidesToScroll:1,adaptiveHeight:!0,children:i.images.map((e,t)=>(0,a.jsx)("div",{className:"relative w-full h-96",children:(0,a.jsx)("img",{src:"".concat("http://localhost:8000")+e.url,alt:i.title,className:"absolute top-0 left-0 w-full h-full object-cover cursor-pointer"})},t))}),(0,a.jsxs)("small",{className:"block mb-2 text-gray-600",children:["Por: ",(null===(t=i.user)||void 0===t?void 0:t.name)||"Usuario Desconocido"," el ",new Date(i.created_at).toLocaleString()]}),(0,a.jsxs)("div",{className:"flex items-center mb-4",children:[(0,a.jsx)(u.Z,{onClick:S,children:(0,a.jsx)(g.Z,{color:i.likes.some(e=>e.user_id===N)?"error":"secondary"})}),(0,a.jsxs)("span",{children:[i.likes.length," Likes"]}),(0,a.jsx)(u.Z,{children:(0,a.jsx)(f.Z,{})}),(0,a.jsxs)("span",{children:[i.comments.length," Comentarios"]})]}),(0,a.jsxs)("div",{children:[i.comments.map(e=>{var t;return(0,a.jsxs)("div",{className:"mb-2",children:[(0,a.jsxs)("strong",{children:[(null===(t=e.user)||void 0===t?void 0:t.name)||"Unknown",":"]})," ",e.text,(0,a.jsx)("small",{className:"block text-gray-500",children:new Date(e.created_at).toLocaleString()})]},e.id)}),(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),C(new FormData(e.currentTarget).get("comment")),e.currentTarget.reset()},children:[(0,a.jsx)(p.Z,{name:"comment",label:"Add a comment",variant:"outlined",fullWidth:!0,className:"mb-2"}),(0,a.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-500 text-white rounded",children:"Comentar"})]})]})]})}):(0,a.jsx)("div",{children:"Post not found"})};function y(){let[e,t]=(0,r.useState)(null),[s,d]=(0,r.useState)(""),[c,m]=(0,r.useState)(""),[h,x]=(0,r.useState)(""),[u,p]=(0,r.useState)("********"),[g,f]=(0,r.useState)([]),[y,w]=(0,r.useState)("public"),[v,N]=(0,r.useState)({newPosts:!0,mentions:!0,messages:!0}),[k,S]=(0,r.useState)(null);(0,r.useEffect)(()=>{o.Z.get("".concat("http://localhost:8000","/api/settings"),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(l.Z.get("auth_token"))}}).then(e=>{let s=e.data;t(s),d(s.name),m(s.email),x(s.profile_photo),f(s.posts)}).catch(e=>{console.error("Error loading user data:",e)})},[]);let C=()=>{o.Z.put("".concat("http://localhost:8000","/api/settings"),{name:s,email:c,profile_photo:h},{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(l.Z.get("auth_token"))}}).then(e=>{alert("Changes saved successfully!")}).catch(e=>{console.error("Error saving changes:",e),alert("Error saving changes. Please try again.")})},E=()=>{S(null)};return e?(0,a.jsxs)("div",{className:"w-full max-w-5xl mx-auto p-4",children:[(0,a.jsxs)("div",{className:"hidden md:grid grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"col-span-3 md:col-span-1 flex flex-col gap-4",children:[(0,a.jsxs)("div",{className:"bg-gray-100 dark:bg-gray-800 rounded-lg p-4 flex items-center gap-4",children:[(0,a.jsx)("div",{className:"w-16 h-16 relative rounded-full overflow-hidden",children:(0,a.jsx)(n.default,{src:h||"/placeholder.svg",alt:s,layout:"fill",objectFit:"cover"})}),(0,a.jsxs)("div",{className:"flex-1 grid gap-1",children:[(0,a.jsx)("div",{className:"text-lg font-medium",children:s}),(0,a.jsx)("div",{className:"text-gray-500 dark:text-gray-400 text-sm",children:c})]}),(0,a.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{if(e.target.files&&e.target.files[0]){let t=e.target.files[0],s=new FormData;s.append("profile_photo",t),o.Z.post("".concat("http://localhost:8000","/api/upload-profile-photo"),s,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer ".concat(l.Z.get("auth_token"))}}).then(e=>{x(e.data.profile_photo),alert("Profile photo updated successfully!")}).catch(e=>{console.error("Error uploading profile photo:",e),alert("Error uploading profile photo. Please try again.")})}},className:"hidden",id:"profile-photo-upload"}),(0,a.jsx)("label",{htmlFor:"profile-photo-upload",className:"cursor-pointer inline-block px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-gray-700 hover:bg-gray-800",children:"Edit Profile"})]}),(0,a.jsxs)("div",{className:"bg-gray-100 dark:bg-gray-800 rounded-lg p-4 grid grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:g.length}),(0,a.jsx)("div",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"Posts"})]}),(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:e.followers_count}),(0,a.jsx)("div",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"Followers"})]}),(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:e.following_count}),(0,a.jsx)("div",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"Following"})]})]})]}),(0,a.jsxs)("div",{className:"col-span-3 md:col-span-2 space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white shadow-md rounded-lg p-6",children:[(0,a.jsx)("div",{className:"text-lg font-medium",children:"Username"}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Update your username to be displayed on your profile."}),(0,a.jsx)("input",{type:"text",value:s,onChange:e=>d(e.target.value),className:"mt-4 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"}),(0,a.jsx)("button",{type:"button",className:"mt-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-gray-700 hover:bg-gray-800",onClick:C,children:"Save"})]}),(0,a.jsxs)("div",{className:"bg-white shadow-md rounded-lg p-6",children:[(0,a.jsx)("div",{className:"text-lg font-medium",children:"Password"}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Update your password to secure your account."}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{htmlFor:"current-password",className:"block text-sm font-medium text-gray-700",children:"Current Password"}),(0,a.jsx)("input",{id:"current-password",type:"password",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{htmlFor:"new-password",className:"block text-sm font-medium text-gray-700",children:"New Password"}),(0,a.jsx)("input",{id:"new-password",type:"password",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{htmlFor:"confirm-password",className:"block text-sm font-medium text-gray-700",children:"Confirm Password"}),(0,a.jsx)("input",{id:"confirm-password",type:"password",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]})]}),(0,a.jsx)("button",{type:"button",className:"mt-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-gray-700 hover:bg-gray-800",onClick:C,children:"Save"})]}),(0,a.jsxs)("div",{className:"bg-white shadow-md rounded-lg p-6",children:[(0,a.jsx)("div",{className:"text-lg font-medium",children:"Email"}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Update your email address to receive notifications."}),(0,a.jsx)("input",{type:"email",value:c,onChange:e=>m(e.target.value),className:"mt-4 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"}),(0,a.jsx)("button",{type:"button",className:"mt-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-gray-700 hover:bg-gray-800",onClick:C,children:"Save"})]}),(0,a.jsxs)("div",{className:"bg-white shadow-md rounded-lg p-6",children:[(0,a.jsx)("div",{className:"text-lg font-medium",children:"Posts"}),(0,a.jsx)("div",{className:"grid grid-cols-3 gap-4 mt-4",children:g.map(e=>(0,a.jsx)(j,{postId:e.id,isOpen:k===e.id,onClose:E,post:e},e.id))})]})]})]}),(0,a.jsx)("div",{className:"md:hidden p-4 mt-8",children:(0,a.jsxs)("div",{className:"bg-gray-100 dark:bg-gray-800 rounded-lg p-4 space-y-4",children:[(0,a.jsx)("div",{className:"text-lg font-medium",children:"Settings"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(i.default,{href:"#",className:"flex items-center justify-between text-sm font-medium text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-50",children:[(0,a.jsx)("span",{children:"Username"}),(0,a.jsx)(b,{className:"w-4 h-4"})]}),(0,a.jsxs)(i.default,{href:"#",className:"flex items-center justify-between text-sm font-medium text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-50",children:[(0,a.jsx)("span",{children:"Password"}),(0,a.jsx)(b,{className:"w-4 h-4"})]}),(0,a.jsxs)(i.default,{href:"#",className:"flex items-center justify-between text-sm font-medium text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-50",children:[(0,a.jsx)("span",{children:"Email"}),(0,a.jsx)(b,{className:"w-4 h-4"})]}),(0,a.jsxs)(i.default,{href:"#",className:"flex items-center justify-between text-sm font-medium text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-50",children:[(0,a.jsx)("span",{children:"Privacy"}),(0,a.jsx)(b,{className:"w-4 h-4"})]}),(0,a.jsxs)(i.default,{href:"#",className:"flex items-center justify-between text-sm font-medium text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-50",children:[(0,a.jsx)("span",{children:"Notifications"}),(0,a.jsx)(b,{className:"w-4 h-4"})]})]})]})})]}):(0,a.jsx)("p",{children:"Loading..."})}function b(e){return(0,a.jsx)("svg",{...e,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,a.jsx)("path",{d:"m9 18 6-6-6-6"})})}}}]);