"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1043],{1043:function(e,a,r){r.r(a),r.d(a,{default:function(){return T}});var s=r(57437),t=r(2265),d=r(44458),n=r(44839),l=r(96164);function i(){for(var e=arguments.length,a=Array(e),r=0;r<e;r++)a[r]=arguments[r];return(0,l.m6)((0,n.W)(a))}let o=t.forwardRef((e,a)=>{let{className:r,...t}=e;return(0,s.jsx)(d.fC,{ref:a,className:i("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",r),...t})});o.displayName=d.fC.displayName;let c=t.forwardRef((e,a)=>{let{className:r,...t}=e;return(0,s.jsx)(d.Ee,{ref:a,className:i("aspect-square h-full w-full",r),...t})});c.displayName=d.Ee.displayName;let g=t.forwardRef((e,a)=>{let{className:r,...t}=e;return(0,s.jsx)(d.NY,{ref:a,className:i("flex h-full w-full items-center justify-center rounded-full bg-gray-100 dark:bg-gray-800",r),...t})});g.displayName=d.NY.displayName;let f=t.forwardRef((e,a)=>{let{className:r,type:t,...d}=e;return(0,s.jsx)("input",{type:t,className:i("flex h-10 w-full rounded-md border border-gray-200 bg-white px-3 py-2 text-sm ring-offset-white file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-gray-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-950 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 dark:border-gray-800 dark:bg-gray-950 dark:ring-offset-gray-950 dark:placeholder:text-gray-400 dark:focus-visible:ring-gray-300",r),ref:a,...d})});f.displayName="Input";var m=r(71538);let u=(0,r(12218).j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-white transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-950 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 dark:ring-offset-gray-950 dark:focus-visible:ring-gray-300",{variants:{variant:{default:"bg-gray-900 text-gray-50 hover:bg-gray-900/90 dark:bg-gray-50 dark:text-gray-900 dark:hover:bg-gray-50/90",destructive:"bg-red-500 text-gray-50 hover:bg-red-500/90 dark:bg-red-900 dark:text-gray-50 dark:hover:bg-red-900/90",outline:"border border-gray-200 bg-white hover:bg-gray-100 hover:text-gray-900 dark:border-gray-800 dark:bg-gray-950 dark:hover:bg-gray-800 dark:hover:text-gray-50",secondary:"bg-gray-100 text-gray-900 hover:bg-gray-100/80 dark:bg-gray-800 dark:text-gray-50 dark:hover:bg-gray-800/80",ghost:"hover:bg-gray-100 hover:text-gray-900 dark:hover:bg-gray-800 dark:hover:text-gray-50",link:"text-gray-900 underline-offset-4 hover:underline dark:text-gray-50"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),h=t.forwardRef((e,a)=>{let{className:r,variant:t,size:d,asChild:n=!1,...l}=e,o=n?m.g7:"button";return(0,s.jsx)(o,{className:i(u({variant:t,size:d,className:r})),ref:a,...l})});h.displayName="Button";var x=r(69789),y=r(87592),p=r(22468),j=r(28165);let v=x.fC,b=x.xz;x.ZA,x.Uv,x.Tr;let w=x.Ee;t.forwardRef((e,a)=>{let{className:r,inset:t,children:d,...n}=e;return(0,s.jsxs)(x.fF,{ref:a,className:i("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-gray-100 data-[state=open]:bg-gray-100 dark:focus:bg-gray-800 dark:data-[state=open]:bg-gray-800",t&&"pl-8",r),...n,children:[d,(0,s.jsx)(y.Z,{className:"ml-auto h-4 w-4"})]})}).displayName=x.fF.displayName,t.forwardRef((e,a)=>{let{className:r,...t}=e;return(0,s.jsx)(x.tu,{ref:a,className:i("z-50 min-w-[8rem] overflow-hidden rounded-md border border-gray-200 bg-white p-1 text-gray-950 shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 dark:border-gray-800 dark:bg-gray-950 dark:text-gray-50",r),...t})}).displayName=x.tu.displayName;let N=t.forwardRef((e,a)=>{let{className:r,sideOffset:t=4,...d}=e;return(0,s.jsx)(x.Uv,{children:(0,s.jsx)(x.VY,{ref:a,sideOffset:t,className:i("z-50 min-w-[8rem] overflow-hidden rounded-md border border-gray-200 bg-white p-1 text-gray-950 shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 dark:border-gray-800 dark:bg-gray-950 dark:text-gray-50",r),...d})})});N.displayName=x.VY.displayName,t.forwardRef((e,a)=>{let{className:r,inset:t,...d}=e;return(0,s.jsx)(x.ck,{ref:a,className:i("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-gray-100 focus:text-gray-900 data-[disabled]:pointer-events-none data-[disabled]:opacity-50 dark:focus:bg-gray-800 dark:focus:text-gray-50",t&&"pl-8",r),...d})}).displayName=x.ck.displayName,t.forwardRef((e,a)=>{let{className:r,children:t,checked:d,...n}=e;return(0,s.jsxs)(x.oC,{ref:a,className:i("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-gray-100 focus:text-gray-900 data-[disabled]:pointer-events-none data-[disabled]:opacity-50 dark:focus:bg-gray-800 dark:focus:text-gray-50",r),checked:d,...n,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(x.wU,{children:(0,s.jsx)(p.Z,{className:"h-4 w-4"})})}),t]})}).displayName=x.oC.displayName;let k=t.forwardRef((e,a)=>{let{className:r,children:t,...d}=e;return(0,s.jsxs)(x.Rk,{ref:a,className:i("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-gray-100 focus:text-gray-900 data-[disabled]:pointer-events-none data-[disabled]:opacity-50 dark:focus:bg-gray-800 dark:focus:text-gray-50",r),...d,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(x.wU,{children:(0,s.jsx)(j.Z,{className:"h-2 w-2 fill-current"})})}),t]})});k.displayName=x.Rk.displayName;let _=t.forwardRef((e,a)=>{let{className:r,inset:t,...d}=e;return(0,s.jsx)(x.__,{ref:a,className:i("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",r),...d})});_.displayName=x.__.displayName;let C=t.forwardRef((e,a)=>{let{className:r,...t}=e;return(0,s.jsx)(x.Z0,{ref:a,className:i("-mx-1 my-1 h-px bg-gray-100 dark:bg-gray-800",r),...t})});C.displayName=x.Z0.displayName;var E=r(44785),z=e=>{let{selectedUser:a,onClose:r}=e,[d,n]=(0,t.useState)([]),[l,i]=(0,t.useState)(""),[m,u]=(0,t.useState)(!0),[x,y]=(0,t.useState)(null);(0,t.useEffect)(()=>{a&&(async()=>{try{let e=await fetch("".concat("http://localhost:8000","/api/messages/").concat(a.id),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(E.Z.get("auth_token"))},credentials:"include"});if(!e.ok)throw Error("Failed to fetch messages");let r=await e.json();n(r),u(!1)}catch(e){e instanceof Error?y(e.message):y("An unknown error occurred"),u(!1)}})()},[a]);let p=async e=>{if(e.preventDefault(),l.trim()&&a)try{let e=await fetch("".concat("http://localhost:8000","/api/messages"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(E.Z.get("auth_token"))},credentials:"include",body:JSON.stringify({receiver_id:a.id,message:l})});if(!e.ok){let a=await e.json();throw Error(a.message||"Failed to send message")}let r=await e.json();n([...d,r]),i("")}catch(e){e instanceof Error?y(e.message):y("An unknown error occurred")}};return m?(0,s.jsx)("div",{children:"Loading..."}):x?(0,s.jsxs)("div",{children:["Error: ",x]}):a?(0,s.jsxs)("div",{className:"flex flex-col h-[80vh] max-w-full mx-auto border border-gray-200 rounded-lg overflow-hidden dark:border-gray-800",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between bg-gray-100 dark:bg-gray-800 px-4 py-3 border-b",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)(o,{className:"w-8 h-8",children:[(0,s.jsx)(c,{alt:"@".concat(a.name),src:a.avatar||"/placeholder-user.jpg"}),(0,s.jsx)(g,{children:a.name[0]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:a.name}),(0,s.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Online"})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)(h,{size:"icon",variant:"ghost",children:[(0,s.jsx)(R,{className:"w-5 h-5"}),(0,s.jsx)("span",{className:"sr-only",children:"Attach file"})]}),(0,s.jsxs)(h,{size:"icon",variant:"ghost",children:[(0,s.jsx)(Z,{className:"w-5 h-5"}),(0,s.jsx)("span",{className:"sr-only",children:"Send emoji"})]})]})]}),(0,s.jsx)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:d.map(e=>(0,s.jsxs)("div",{className:"flex items-end gap-3 ".concat(e.sender_id===a.id?"justify-start":"justify-end"),children:[e.sender_id!==a.id&&(0,s.jsxs)(o,{className:"w-8 h-8",children:[(0,s.jsx)(c,{alt:"@".concat(a.name),src:a.avatar||"/placeholder-user.jpg"}),(0,s.jsx)(g,{children:a.name[0]})]}),(0,s.jsx)("div",{className:"px-4 py-2 rounded-lg max-w-[70%] ".concat(e.sender_id===a.id?"bg-gray-100 dark:bg-gray-800 rounded-bl-none":"bg-blue-500 text-white rounded-br-none"),children:e.content}),e.sender_id===a.id&&(0,s.jsxs)(o,{className:"w-8 h-8",children:[(0,s.jsx)(c,{alt:"@".concat(a.name),src:a.avatar||"/placeholder-user.jpg"}),(0,s.jsx)(g,{children:a.name[0]})]})]},e.id))}),(0,s.jsx)("div",{className:"bg-gray-100 dark:bg-gray-800 px-4 py-3 border-t",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(f,{autoComplete:"off",className:"flex-1",placeholder:"Type your message...",value:l,onChange:e=>i(e.target.value)}),(0,s.jsxs)(h,{size:"icon",variant:"ghost",onClick:p,children:[(0,s.jsx)(S,{className:"w-5 h-5"}),(0,s.jsx)("span",{className:"sr-only",children:"Send message"})]})]})})]}):(0,s.jsx)("div",{children:"No user selected"})};function R(e){return(0,s.jsx)("svg",{...e,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,s.jsx)("path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48"})})}function S(e){return(0,s.jsxs)("svg",{...e,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("path",{d:"m22 2-7 20-4-9-9-4Z"}),(0,s.jsx)("path",{d:"M22 2 11 13"})]})}function Z(e){return(0,s.jsxs)("svg",{...e,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,s.jsx)("path",{d:"M8 14s1.5 2 4 2 4-2 4-2"}),(0,s.jsx)("line",{x1:"9",x2:"9.01",y1:"9",y2:"9"}),(0,s.jsx)("line",{x1:"15",x2:"15.01",y1:"9",y2:"9"})]})}var A=r(77699),L=r(23761);function T(){let[e,a]=(0,t.useState)([]),[r,d]=(0,t.useState)(!0),[n,l]=(0,t.useState)(null),[i,m]=(0,t.useState)(null);(0,t.useEffect)(()=>{(async()=>{try{let e=await fetch("".concat("http://localhost:8000","/api/conversations"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(E.Z.get("auth_token"))},credentials:"include"});if(!e.ok)throw Error("Failed to fetch conversations");let r=await e.json();a(r),d(!1)}catch(e){e instanceof Error?l(e.message):l("An unknown error occurred"),d(!1)}})()},[]);let u=e=>{m(e)};return r?(0,s.jsx)("div",{children:"Loading..."}):n?(0,s.jsxs)("div",{children:["Error: ",n]}):(0,s.jsx)("div",{className:"w-full max-w-4xl mx-auto py-6 px-4 md:px-6",children:i?(0,s.jsx)(z,{selectedUser:i,onClose:()=>{m(null)}}):(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:"w-full bg-gray-100 dark:bg-gray-800 rounded-lg overflow-hidden",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4 px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:[(0,s.jsxs)("div",{className:"relative flex-1",children:[(0,s.jsx)(A.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-500 dark:text-gray-400"}),(0,s.jsx)(f,{className:"pl-10 pr-4 py-2 rounded-md w-full bg-white dark:bg-gray-950 focus:outline-none focus:ring-1 focus:ring-gray-950 dark:focus:ring-gray-300",placeholder:"Search messages...",type:"search"})]}),(0,s.jsxs)(v,{children:[(0,s.jsx)(b,{asChild:!0,children:(0,s.jsxs)(h,{className:"rounded-full",size:"icon",variant:"ghost",children:[(0,s.jsx)(L.Z,{className:"w-5 h-5"}),(0,s.jsx)("span",{className:"sr-only",children:"Filter messages"})]})}),(0,s.jsxs)(N,{align:"end",className:"w-48",children:[(0,s.jsx)(_,{children:"Sort by"}),(0,s.jsx)(C,{}),(0,s.jsxs)(w,{value:"recent",children:[(0,s.jsx)(k,{value:"recent",children:"Recent"}),(0,s.jsx)(k,{value:"unread",children:"Unread"}),(0,s.jsx)(k,{value:"oldest",children:"Oldest"})]})]})]})]}),(0,s.jsx)("div",{className:"h-[calc(100vh_-_theme(spacing.24)_-_theme(spacing.6))] overflow-y-auto",children:(0,s.jsx)("div",{className:"grid gap-4 p-4",children:e.map(e=>(0,s.jsxs)("div",{className:"flex items-start gap-4 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors cursor-pointer",onClick:()=>u({id:e.id,name:e.name,avatar:e.avatar}),children:[(0,s.jsxs)(o,{className:"w-12 h-12",children:[(0,s.jsx)(c,{alt:"@".concat(e.name),src:e.avatar||"/placeholder-user.jpg"}),(0,s.jsx)(g,{children:e.name[0]})]}),(0,s.jsxs)("div",{className:"flex-1 grid gap-1",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("div",{className:"font-medium",children:e.name}),e.last_message&&(0,s.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:new Date(e.last_message.created_at).toLocaleTimeString()})]}),(0,s.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400 line-clamp-1",children:e.last_message?e.last_message.content:"No messages yet"})]})]},e.id))})})]})})})}}}]);