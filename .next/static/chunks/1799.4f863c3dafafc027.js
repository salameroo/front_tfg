"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1799],{1799:function(e,t,a){a.r(t),a.d(t,{default:function(){return el}});var r=a(7437),l=a(2265),o=a(2649),n=a(6548),i=a(3950),s=a(2988),c=a(4839),d=a(6259),p=a(674),u=a(2272),m=a(7594),h=a(5635),A=a(4990),x=a(8510),g=a(8024),b=a(4535),f=a(7542);function v(e){return(0,f.ZP)("MuiDialog",e)}let w=(0,b.Z)("MuiDialog",["root","scrollPaper","scrollBody","container","paper","paperScrollPaper","paperScrollBody","paperWidthFalse","paperWidthXs","paperWidthSm","paperWidthMd","paperWidthLg","paperWidthXl","paperFullWidth","paperFullScreen"]),Z=l.createContext({});var j=a(4593),k=a(2960);let S=["aria-describedby","aria-labelledby","BackdropComponent","BackdropProps","children","className","disableEscapeKeyDown","fullScreen","fullWidth","maxWidth","onBackdropClick","onClick","onClose","open","PaperComponent","PaperProps","scroll","TransitionComponent","transitionDuration","TransitionProps"],y=(0,g.ZP)(j.Z,{name:"MuiDialog",slot:"Backdrop",overrides:(e,t)=>t.backdrop})({zIndex:-1}),C=e=>{let{classes:t,scroll:a,maxWidth:r,fullWidth:l,fullScreen:o}=e,n={root:["root"],container:["container","scroll".concat((0,u.Z)(a))],paper:["paper","paperScroll".concat((0,u.Z)(a)),"paperWidth".concat((0,u.Z)(String(r))),l&&"paperFullWidth",o&&"paperFullScreen"]};return(0,d.Z)(n,v,t)},N=(0,g.ZP)(m.Z,{name:"MuiDialog",slot:"Root",overridesResolver:(e,t)=>t.root})({"@media print":{position:"absolute !important"}}),M=(0,g.ZP)("div",{name:"MuiDialog",slot:"Container",overridesResolver:(e,t)=>{let{ownerState:a}=e;return[t.container,t["scroll".concat((0,u.Z)(a.scroll))]]}})(e=>{let{ownerState:t}=e;return(0,s.Z)({height:"100%","@media print":{height:"auto"},outline:0},"paper"===t.scroll&&{display:"flex",justifyContent:"center",alignItems:"center"},"body"===t.scroll&&{overflowY:"auto",overflowX:"hidden",textAlign:"center","&::after":{content:'""',display:"inline-block",verticalAlign:"middle",height:"100%",width:"0"}})}),B=(0,g.ZP)(A.Z,{name:"MuiDialog",slot:"Paper",overridesResolver:(e,t)=>{let{ownerState:a}=e;return[t.paper,t["scrollPaper".concat((0,u.Z)(a.scroll))],t["paperWidth".concat((0,u.Z)(String(a.maxWidth)))],a.fullWidth&&t.paperFullWidth,a.fullScreen&&t.paperFullScreen]}})(e=>{let{theme:t,ownerState:a}=e;return(0,s.Z)({margin:32,position:"relative",overflowY:"auto","@media print":{overflowY:"visible",boxShadow:"none"}},"paper"===a.scroll&&{display:"flex",flexDirection:"column",maxHeight:"calc(100% - 64px)"},"body"===a.scroll&&{display:"inline-block",verticalAlign:"middle",textAlign:"left"},!a.maxWidth&&{maxWidth:"calc(100% - 64px)"},"xs"===a.maxWidth&&{maxWidth:"px"===t.breakpoints.unit?Math.max(t.breakpoints.values.xs,444):"max(".concat(t.breakpoints.values.xs).concat(t.breakpoints.unit,", 444px)"),["&.".concat(w.paperScrollBody)]:{[t.breakpoints.down(Math.max(t.breakpoints.values.xs,444)+64)]:{maxWidth:"calc(100% - 64px)"}}},a.maxWidth&&"xs"!==a.maxWidth&&{maxWidth:"".concat(t.breakpoints.values[a.maxWidth]).concat(t.breakpoints.unit),["&.".concat(w.paperScrollBody)]:{[t.breakpoints.down(t.breakpoints.values[a.maxWidth]+64)]:{maxWidth:"calc(100% - 64px)"}}},a.fullWidth&&{width:"calc(100% - 64px)"},a.fullScreen&&{margin:0,width:"100%",maxWidth:"100%",height:"100%",maxHeight:"none",borderRadius:0,["&.".concat(w.paperScrollBody)]:{margin:0,maxWidth:"100%"}})}),D=l.forwardRef(function(e,t){let a=(0,x.Z)({props:e,name:"MuiDialog"}),o=(0,k.Z)(),n={enter:o.transitions.duration.enteringScreen,exit:o.transitions.duration.leavingScreen},{"aria-describedby":d,"aria-labelledby":u,BackdropComponent:m,BackdropProps:g,children:b,className:f,disableEscapeKeyDown:v=!1,fullScreen:w=!1,fullWidth:j=!1,maxWidth:D="sm",onBackdropClick:W,onClick:R,onClose:P,open:E,PaperComponent:U=A.Z,PaperProps:T={},scroll:L="paper",TransitionComponent:I=h.Z,transitionDuration:F=n,TransitionProps:O}=a,V=(0,i.Z)(a,S),_=(0,s.Z)({},a,{disableEscapeKeyDown:v,fullScreen:w,fullWidth:j,maxWidth:D,scroll:L}),K=C(_),Q=l.useRef(),H=(0,p.Z)(u),q=l.useMemo(()=>({titleId:H}),[H]);return(0,r.jsx)(N,(0,s.Z)({className:(0,c.Z)(K.root,f),closeAfterTransition:!0,components:{Backdrop:y},componentsProps:{backdrop:(0,s.Z)({transitionDuration:F,as:m},g)},disableEscapeKeyDown:v,onClose:P,open:E,ref:t,onClick:e=>{R&&R(e),Q.current&&(Q.current=null,W&&W(e),P&&P(e,"backdropClick"))},ownerState:_},V,{children:(0,r.jsx)(I,(0,s.Z)({appear:!0,in:E,timeout:F,role:"presentation"},O,{children:(0,r.jsx)(M,{className:(0,c.Z)(K.container),onMouseDown:e=>{Q.current=e.target===e.currentTarget},ownerState:_,children:(0,r.jsx)(B,(0,s.Z)({as:U,elevation:24,role:"dialog","aria-describedby":d,"aria-labelledby":H},T,{className:(0,c.Z)(K.paper,T.className),ownerState:_,children:(0,r.jsx)(Z.Provider,{value:q,children:b})}))})}))}))});var W=a(511);function R(e){return(0,f.ZP)("MuiDialogTitle",e)}let P=(0,b.Z)("MuiDialogTitle",["root"]),E=["className","id"],U=e=>{let{classes:t}=e;return(0,d.Z)({root:["root"]},R,t)},T=(0,g.ZP)(W.Z,{name:"MuiDialogTitle",slot:"Root",overridesResolver:(e,t)=>t.root})({padding:"16px 24px",flex:"0 0 auto"}),L=l.forwardRef(function(e,t){let a=(0,x.Z)({props:e,name:"MuiDialogTitle"}),{className:o,id:n}=a,d=(0,i.Z)(a,E),p=U(a),{titleId:u=n}=l.useContext(Z);return(0,r.jsx)(T,(0,s.Z)({component:"h2",className:(0,c.Z)(p.root,o),ownerState:a,ref:t,variant:"h6",id:null!=n?n:u},d))});function I(e){return(0,f.ZP)("MuiDialogContent",e)}(0,b.Z)("MuiDialogContent",["root","dividers"]);let F=["className","dividers"],O=e=>{let{classes:t,dividers:a}=e;return(0,d.Z)({root:["root",a&&"dividers"]},I,t)},V=(0,g.ZP)("div",{name:"MuiDialogContent",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:a}=e;return[t.root,a.dividers&&t.dividers]}})(e=>{let{theme:t,ownerState:a}=e;return(0,s.Z)({flex:"1 1 auto",WebkitOverflowScrolling:"touch",overflowY:"auto",padding:"20px 24px"},a.dividers?{padding:"16px 24px",borderTop:"1px solid ".concat((t.vars||t).palette.divider),borderBottom:"1px solid ".concat((t.vars||t).palette.divider)}:{[".".concat(P.root," + &")]:{paddingTop:0}})}),_=l.forwardRef(function(e,t){let a=(0,x.Z)({props:e,name:"MuiDialogContent"}),{className:l,dividers:o=!1}=a,n=(0,i.Z)(a,F),d=(0,s.Z)({},a,{dividers:o}),p=O(d);return(0,r.jsx)(V,(0,s.Z)({className:(0,c.Z)(p.root,l),ownerState:d,ref:t},n))});function K(e){return(0,f.ZP)("MuiDialogActions",e)}(0,b.Z)("MuiDialogActions",["root","spacing"]);let Q=["className","disableSpacing"],H=e=>{let{classes:t,disableSpacing:a}=e;return(0,d.Z)({root:["root",!a&&"spacing"]},K,t)},q=(0,g.ZP)("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:a}=e;return[t.root,!a.disableSpacing&&t.spacing]}})(e=>{let{ownerState:t}=e;return(0,s.Z)({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto"},!t.disableSpacing&&{"& > :not(style) ~ :not(style)":{marginLeft:8}})}),Y=l.forwardRef(function(e,t){let a=(0,x.Z)({props:e,name:"MuiDialogActions"}),{className:l,disableSpacing:o=!1}=a,n=(0,i.Z)(a,Q),d=(0,s.Z)({},a,{disableSpacing:o}),p=H(d);return(0,r.jsx)(q,(0,s.Z)({className:(0,c.Z)(p.root,l),ownerState:d,ref:t},n))});var z=a(670);function G(){return(0,z.mE)().map}var X=a(5393),J=a(8977),$=a(707),ee=a(7691),et=a.n(ee);a(966),et().Icon.Default.mergeOptions({iconRetinaUrl:{src:"/_next/static/media/marker-icon-2x.93fdb12c.png",height:82,width:50,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAICAMAAAAGL8UJAAAANlBMVEUzMxxFksk+gbNBkcgwdbI4fbM2jMsygsNxqtQndZwtdKkdeshBk8z//Pgrh9VBk9RSp+JTp+PelCMqAAAADnRSTlMBrx64VFz0xvwNhvvj/jeiprIAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAuSURBVHicBcEJAgAQCADBjShX8f/PmqHIlkK9/irdj3csPY0WKxpYGKChwJiDDxwKAR4UXhghAAAAAElFTkSuQmCC",blurWidth:5,blurHeight:8},iconUrl:{src:"/_next/static/media/marker-icon.d577052a.png",height:41,width:25,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAICAMAAAAGL8UJAAAAKlBMVEVGLgAygcE/f6tFkshxqtQ5jcsweLE4fbMefMkvc6j///wriNZBldVUqORqwSgIAAAAC3RSTlMBxhOv/O5VXPqL/OmAXwIAAAAJcEhZcwAACxMAAAsTAQCanBgAAAArSURBVHicBcGHAQAgCMCwslXg/3dNUAtTbH2N8OeBjI9QfbpAWoDsBPQqHxRqAMvu5x30AAAAAElFTkSuQmCC",blurWidth:5,blurHeight:8},shadowUrl:{src:"/_next/static/media/marker-shadow.612e3b52.png",height:41,width:41,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAElBMVEUAAAAAAAAAAAAAAAAAAAAAAADgKxmiAAAABnRSTlMBH00NOF/KpzdKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAI0lEQVR4nGNgwAsYGZmZwTQTCyMjiMHEysQCYzCCpVhYQBQABLIAOAyhL1kAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8}});var ea=e=>{let{onLocationSelected:t,center:a}=e,o=(0,l.useRef)(null);return(0,r.jsxs)(J.h,{center:a||{lat:51.505,lng:-.09},zoom:13,style:{height:"400px",width:"100%"},children:[(0,r.jsx)($.I,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}),(0,r.jsx)(()=>{let e=G();return(0,l.useEffect)(()=>{a&&(e.setView(a,13),o.current&&o.current.setLatLng(a))},[a,e]),!function(e,t){let a=G();(0,l.useEffect)(function(){return a.on(e,t),function(){a.off(e,t)}},[a,e,t])}("click",e=>{let{lat:a,lng:r}=e.latlng;o.current&&o.current.setLatLng(e.latlng),t({lat:a,lng:r},"Lat: ".concat(a,", Lng: ").concat(r))}),a?(0,r.jsx)(X.J,{position:a,ref:o}):null},{})]})},er=e=>{let{onLocationSelected:t}=e,[a,o]=(0,l.useState)(""),[n,i]=(0,l.useState)([]),s=async e=>{e.preventDefault();let t=await fetch("https://nominatim.openstreetmap.org/search?format=json&q=".concat(a));i(await t.json())},c=(e,a,r)=>{t({lat:e,lng:a},r),o(r),i([])};return(0,r.jsxs)("div",{children:[(0,r.jsxs)("form",{onSubmit:s,children:[(0,r.jsx)("input",{type:"text",value:a,onChange:e=>o(e.target.value),placeholder:"Buscar ubicaci\xf3n...",className:"p-2 border rounded"}),(0,r.jsx)("button",{type:"submit",className:"ml-2 p-2 bg-blue-500 text-white rounded",children:"Buscar"})]}),n.length>0&&(0,r.jsx)("ul",{className:"mt-2 border rounded p-2",children:n.map(e=>(0,r.jsx)("li",{onClick:()=>c(e.lat,e.lon,e.display_name),className:"cursor-pointer p-2 hover:bg-gray-200",children:e.display_name},e.place_id))})]})};function el(){let[e,t]=(0,l.useState)({title:"",images:[],description:"",tag_ppl:"",location:"",alias:""}),[a,i]=(0,l.useState)([]),[s,c]=(0,l.useState)(!1),[d,p]=(0,l.useState)(!1),[u,m]=(0,l.useState)(null),[h,A]=(0,l.useState)(!1),[x,g]=(0,l.useState)(null),[b,f]=(0,l.useState)(null),[v,w]=(0,l.useState)({lat:51.505,lng:-.09}),Z=a=>{let{name:r,value:l,files:o}=a.target;if("images"===r&&o){if(o.length>0){if(e.images.length+o.length>10){m("No se pueden subir m\xe1s de 10 im\xe1genes.");return}c(!0),p(!1),m(null);let a=[],r=[];for(let e=0;e<o.length;e++){let t=o[e];a.push(new Promise(e=>{let a=new FileReader;a.onload=()=>{let t=a.result;r.push(t),e(t)},a.readAsDataURL(t)}))}Promise.all(a).then(e=>{i(t=>[...t,...e]),t(e=>({...e,images:[...e.images,...r]})),c(!1)})}else i([])}else t(e=>({...e,[r]:l}))},j=async()=>{if(!(await fetch("".concat("http://localhost:8000","/sanctum/csrf-cookie"),{credentials:"include"})).ok)throw Error("Failed to fetch CSRF token")},k=async t=>{t.preventDefault(),await j();let a=o.Z.get("auth_token");try{c(!0),p(!1);let t=await fetch("".concat("http://localhost:8000","/api/newpost"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)},body:JSON.stringify({...e,latitude:x,longitude:b}),credentials:"include"});if(!t.ok){let e=await t.json();throw Error(e.message||"Error al crear la publicaci\xf3n")}p(!0),c(!1)}catch(e){e instanceof Error?m(e.message):m("An unknown error occurred"),c(!1)}},S=(e,a)=>{g(e.lat),f(e.lng),w(e),t(e=>({...e,location:a}))};return(0,r.jsxs)("div",{className:"max-w-md mx-auto",children:[(0,r.jsx)("h1",{className:"text-black text-bold text-center mt-8 mb-2 font-sans text-2xl",children:"Nuevo Post"}),(0,r.jsxs)("form",{onSubmit:k,children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{htmlFor:"images",className:"block text-gray-700 font-semibold mb-4",children:"Im\xe1genes"}),(0,r.jsxs)("label",{className:"bg-gradient-to-r from-cyan-500 to-blue-500 hover:from-green-500 hover:to-blue-500 text-white font-semibold py-2 px-4 rounded-md cursor-pointer transition duration-200 ease-in-out w-full text-center",children:["Subir Im\xe1genes",(0,r.jsx)("input",{type:"file",id:"images",name:"images",accept:"image/*",multiple:!0,style:{display:"none"},onChange:Z})]}),s&&(0,r.jsx)("div",{className:"text-center mt-2",children:"Cargando..."}),a.length>0&&!s&&(0,r.jsx)("div",{className:"mt-2",children:a.map((e,t)=>(0,r.jsx)("img",{src:e,alt:"Preview",className:"rounded-md border mb-2",style:{maxWidth:"200px",maxHeight:"200px"}},t))}),u&&(0,r.jsx)("div",{className:"text-red-500 text-center mt-2",children:u}),d&&(0,r.jsx)("div",{className:"text-green-500 text-center mt-2",children:"Las im\xe1genes se han cargado correctamente. Post publicado"})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{htmlFor:"title",className:"block text-gray-700 font-semibold",children:"T\xedtulo "}),(0,r.jsx)("input",{type:"text",id:"title",name:"title",value:e.title||"",onChange:Z,className:"text-black mt-1 p-2 border rounded-md w-full",required:!0})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{htmlFor:"tag_ppl",className:"block text-gray-700 font-semibold",children:"Etiqueta Personas"}),(0,r.jsx)("input",{type:"text",id:"tag_ppl",name:"tag_ppl",value:e.tag_ppl||"",onChange:Z,className:"text-black mt-1 p-2 border rounded-md w-full"})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{htmlFor:"description",className:"block text-gray-700 font-semibold",children:"Descripci\xf3n"}),(0,r.jsx)("textarea",{id:"description",name:"description",value:e.description||"",onChange:Z,rows:4,className:"text-black mt-1 p-2 border rounded-md w-full"})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{htmlFor:"location",className:"block text-gray-700 font-semibold",children:"Ubicaci\xf3n"}),(0,r.jsx)("input",{type:"text",id:"location",name:"location",value:e.location||"",readOnly:!0,className:"text-black mt-1 p-2 border rounded-md w-full",hidden:!0}),(0,r.jsx)(n.Z,{onClick:()=>A(!0),className:"mt-2 p-2 bg-blue-500 text-white rounded-md",children:"Seleccionar Ubicaci\xf3n"})]}),(0,r.jsx)(n.Z,{type:"submit",className:"bg-gradient-to-bl from-purple-500 via-pink-500 to-red-500 hover:from-red-500 hover:via-pink-500 hover:to-purple-500 text-white font-bold py-2 px-4 rounded hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded-md mb-4 mt-2 w-full",children:"Publicar"})]}),(0,r.jsxs)(D,{open:h,onClose:()=>A(!1),fullWidth:!0,maxWidth:"md",children:[(0,r.jsx)(L,{children:"Selecciona la Ubicaci\xf3n"}),(0,r.jsxs)(_,{children:[(0,r.jsx)(er,{onLocationSelected:S}),(0,r.jsx)(ea,{onLocationSelected:S,center:v})]}),(0,r.jsx)(Y,{children:(0,r.jsx)(n.Z,{onClick:()=>A(!1),color:"primary",children:"Cerrar"})})]})]})}}}]);